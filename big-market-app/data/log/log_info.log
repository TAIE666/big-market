25-06-26.14:21:20.468 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_391 on LAPTOP-RN9B7MCO with PID 21856 (started by 11140 in E:\java\Project\big-market\big-market-app)
25-06-26.14:21:20.470 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
25-06-26.14:21:23.534 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-06-26.14:21:23.554 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-06-26.14:21:23.671 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 84 ms. Found 0 Redis repository interfaces.
25-06-26.14:21:27.450 [main            ] INFO  Version                - Redisson 3.23.4
25-06-26.14:21:28.766 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 192.168.48.128/192.168.48.128:16379
25-06-26.14:21:28.786 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 192.168.48.128/192.168.48.128:16379
25-06-26.14:21:35.854 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-06-26.14:21:36.008 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.48.128:5672]
25-06-26.14:21:36.305 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5ebfe7fa:0/SimpleConnection@53dd29e0 [delegate=amqp://admin@192.168.48.128:5672/, localPort= 4874]
25-06-26.14:21:36.450 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 16.992 seconds (JVM running for 20.662)
25-06-26.14:21:36.962 [main            ] INFO  RaffleActivityController - 活动抽奖 userId:coudou activityId:100301
25-06-26.14:21:37.219 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-06-26.14:21:38.064 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-06-26.14:21:38.214 [main            ] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:coudou activityId:100301 orderId:637860220076
25-06-26.14:21:38.253 [main            ] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: coudou strategyId: 100006 ruleModel: rule_default awardId: 107
25-06-26.14:21:38.255 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 coudou 100006 107 rule_default
25-06-26.14:21:38.255 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-06-26.14:21:38.292 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-06-26.14:21:38.328 [main            ] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:coudou strategyId:100006 awardId:107
25-06-26.14:21:38.341 [main            ] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁【放行】 userId:coudou strategyId:100006 awardId:107 raffleCount:2 userRaffleCount:2
25-06-26.14:21:38.342 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_lock code:0000
25-06-26.14:21:38.344 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:coudou strategyId:100006 awardId:107
25-06-26.14:21:38.351 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:coudou strategyId:100006 awardId:107
25-06-26.14:21:38.426 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock_1 node:rule_stock code:0001
25-06-26.14:21:38.426 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 coudou 100006 107 
25-06-26.14:21:38.871 [main            ] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":107,"awardTitle":"2等奖","userId":"coudou"},"id":"04332023191","timestamp":1750918898442}
25-06-26.14:21:38.885 [main            ] INFO  RaffleActivityControllerTest - 请求参数：{"activityId":100301,"userId":"coudou"}
25-06-26.14:21:38.886 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":107,"awardTitle":"2等奖","userId":"coudou"},"id":"04332023191","timestamp":1750918898442}
25-06-26.14:21:38.892 [main            ] INFO  RaffleActivityControllerTest - 测试结果：{"code":"0000","data":{"awardId":107,"awardIndex":7,"awardTitle":"2等奖"},"info":"调用成功"}
25-06-26.14:21:38.918 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-06-26.14:21:38.921 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-06-26.14:21:39.432 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-06-26.14:21:39.900 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-06-26.14:21:39.905 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-06-26.14:21:39.906 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-06-26.14:21:53.082 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_391 on LAPTOP-RN9B7MCO with PID 20848 (started by 11140 in E:\java\Project\big-market\big-market-app)
25-06-26.14:21:53.085 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
25-06-26.14:21:54.838 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-06-26.14:21:54.844 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-06-26.14:21:54.939 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 71 ms. Found 0 Redis repository interfaces.
25-06-26.14:21:57.931 [main            ] INFO  Version                - Redisson 3.23.4
25-06-26.14:21:59.456 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 192.168.48.128/192.168.48.128:16379
25-06-26.14:21:59.476 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 192.168.48.128/192.168.48.128:16379
25-06-26.14:22:05.923 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-06-26.14:22:06.083 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [192.168.48.128:5672]
25-06-26.14:22:06.212 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#56a9b662:0/SimpleConnection@8cce9ad [delegate=amqp://admin@192.168.48.128:5672/, localPort= 4989]
25-06-26.14:22:06.402 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 14.022 seconds (JVM running for 16.274)
25-06-26.14:22:06.835 [main            ] INFO  RaffleStrategyController - 查询抽奖奖品列表配开始 userId:coudou activityId：100301
25-06-26.14:22:06.892 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-06-26.14:22:07.653 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-06-26.14:22:36.700 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
25-06-26.14:23:15.964 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m8s203ms312µs700ns).
25-06-26.14:25:02.785 [Retail_HikariCP housekeeper] WARN  HikariPool             - Retail_HikariCP - Thread starvation or clock leap detected (housekeeper delta=1m46s820ms758µs200ns).
25-06-26.14:25:02.830 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
25-06-26.14:25:02.870 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-06-26.14:25:02.879 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
25-06-26.14:25:02.947 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-06-26.14:25:02.958 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
25-06-26.14:25:03.567 [main            ] INFO  RaffleStrategyController - 查询抽奖奖品列表配置完成 userId:coudou activityId：100301 response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"7等奖","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"6等奖","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"5等奖","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardTitle":"4等奖","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardSubtitle":"抽奖1次后解锁","awardTitle":"3等奖","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardSubtitle":"抽奖1次后解锁","awardTitle":"2等奖","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardSubtitle":"抽奖2次后解锁","awardTitle":"1等奖","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"调用成功"}
25-06-26.14:25:03.571 [main            ] INFO  RaffleStrategyControllerTest - 请求参数：{"activityId":100301,"userId":"coudou"}
25-06-26.14:25:03.572 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnLockCount":0},{"awardId":102,"awardTitle":"7等奖","isAwardUnlock":true,"sort":2,"waitUnLockCount":0},{"awardId":103,"awardTitle":"6等奖","isAwardUnlock":true,"sort":3,"waitUnLockCount":0},{"awardId":104,"awardTitle":"5等奖","isAwardUnlock":true,"sort":4,"waitUnLockCount":0},{"awardId":105,"awardTitle":"4等奖","isAwardUnlock":true,"sort":5,"waitUnLockCount":0},{"awardId":106,"awardSubtitle":"抽奖1次后解锁","awardTitle":"3等奖","isAwardUnlock":true,"sort":6,"waitUnLockCount":0},{"awardId":107,"awardSubtitle":"抽奖1次后解锁","awardTitle":"2等奖","isAwardUnlock":true,"sort":7,"waitUnLockCount":0},{"awardId":108,"awardSubtitle":"抽奖2次后解锁","awardTitle":"1等奖","isAwardUnlock":true,"sort":8,"waitUnLockCount":0}],"info":"调用成功"}
25-06-26.14:25:03.605 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-06-26.14:25:03.609 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-06-26.14:25:03.800 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-06-26.14:25:03.800 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-06-26.14:25:03.810 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-06-26.14:25:03.812 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
